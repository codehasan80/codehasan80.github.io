<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Sıralama Sonucu</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      font-size: 18px;
    }
    #result {
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <h1>Sıralamanız</h1>
  <div id="result"></div>

  <script>
    const gender = localStorage.getItem("lastGender");
    const city = localStorage.getItem("lastCity");
    const score = localStorage.getItem("lastScore");
    const username = localStorage.getItem("lastUsername");

    const resultDiv = document.getElementById("result");

    if (!gender || !city || !score || !username) {
      resultDiv.innerText = "Sıralama bilgileri eksik.";
    } else {
      const storageKey = gender === "Kadın" ? "femaleScores" : "maleScores";
      const data = JSON.parse(localStorage.getItem(storageKey)) || [];

      // Şehir içi sıralama
      const cityEntries = data.filter(e => e.city === city);
      cityEntries.sort((a, b) => parseFloat(b.score.replace(",", ".")) - parseFloat(a.score.replace(",", ".")));
      const cityRank = cityEntries.findIndex(e => e.score === score && e.username === username) + 1;
      const cityTotal = cityEntries.length;

      // Genel sıralama (aynı cinsiyet, tüm şehirler)
      const allEntries = [...data];
      allEntries.sort((a, b) => parseFloat(b.score.replace(",", ".")) - parseFloat(a.score.replace(",", ".")));
      const generalRank = allEntries.findIndex(e => e.score === score && e.username === username) + 1;
      const generalTotal = allEntries.length;

      resultDiv.innerHTML = `
        <p><strong>${city}</strong> şehrinde <strong>${cityTotal}</strong> kişi arasında <strong>${cityRank}. sıradasınız.</strong></p>
        <p><strong>Tüm şehirler</strong> içinde <strong>${generalTotal}</strong> kişi arasında <strong>${generalRank}. sıradasınız.</strong></p>
        <p><a href="index.html">Yeni kayıt için dön</a></p>
      `;
    }
  </script>
</body>
</html>
